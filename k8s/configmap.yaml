apiVersion: v1
kind: ConfigMap
metadata:
  name: kamailio-config
  namespace: kamailio
data:
  kamailio.cfg: |
    #!KAMAILIO
    # Kamailio SIP Server Configuration
    # Enhanced configuration for SIP testing with proper response handling
    
    ####### Global Parameters #########
    debug=2
    log_stderror=yes
    log_facility=LOG_LOCAL0
    
    /* number of children processes to be created for handling requests */
    children=4
    
    /* add local domain aliases */
    alias="kamailio.local"
    
    /* listen addresses */
    listen=udp:0.0.0.0:5060
    listen=tcp:0.0.0.0:5060
    
    /* core modules */
    loadmodule "tm.so"
    loadmodule "sl.so"
    loadmodule "xlog.so"
    loadmodule "rr.so"
    loadmodule "pv.so"
    
    /* routing logic */
    request_route {
        # Log all requests
        xlog("L_INFO", "Received SIP request\n");
        
        # Handle all requests with proper SIP response
        sl_send_reply("200", "OK");
        exit;
    } 